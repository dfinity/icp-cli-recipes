{{! A recipe for deploying a pre-built canister }}
{{! `path: string` path to the wasm }}
{{! `sha256: string` Optional, the hash of the wasm to deploy}}
{{! `metadata: [name: string, value: string]`: An array of name/value pairs that get injected into the wasm metadata section }}

build:

  steps:

    - type: pre-built
      path: {{ path }}
      {{#if sha256 }}
      sha256: {{ sha256 }}
      {{/if}}

    {{#if metadata}}
    - type: script
      commands:
        {{#each metadata}}
        - sh -c 'command -v ic-wasm >/dev/null 2>&1 || { echo >&2 "ic-wasm not found. To install ic-wasm, see https://github.com/dfinity/ic-wasm \n"; exit 1; }'
        - sh -c 'ic-wasm "$ICP_WASM_OUTPUT_PATH" -o "${ICP_WASM_OUTPUT_PATH}" metadata "{{ name }}" -d "{{ value }}" --keep-name-section'
        {{/each}}
    {{/if}}

